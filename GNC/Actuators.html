<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>MAPLEAF.GNC.Actuators API documentation</title>
<meta name="description" content="Modelling of actuators, which can control things like the position of rocket fin angles..." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
<style>.homelink{display:block;font-size:2em;font-weight:bold;color:#555;padding-bottom:.5em;border-bottom:1px solid silver}.homelink:hover{color:inherit}.homelink img{max-width:20%;max-height:5em;margin:auto;margin-bottom:.3em}</style>
<link rel="canonical" href="https://pdoc3.github.io/pdoc/doc/MAPLEAF/GNC/Actuators.html">
<link rel="icon" href="https://pdoc3.github.io/pdoc/logo.png">
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>MAPLEAF.GNC.Actuators</code></h1>
</header>
<section id="section-intro">
<p>Modelling of actuators, which can control things like the position of rocket fin angles&hellip;</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#39;&#39;&#39;
Modelling of actuators, which can control things like the position of rocket fin angles...
&#39;&#39;&#39;

import abc
from math import e

import numpy as np
from scipy.interpolate import LinearNDInterpolator

from MAPLEAF.Motion import AeroParameters

__all__ = [ &#34;TableInterpolatingActuatorController&#34;, &#34;FirstOrderActuator&#34;, &#34;FirstOrderSystem&#34;, &#34;ActuatorController&#34;, &#34;Actuator&#34; ]

class FirstOrderSystem():
    def __init__(self, responseTime):
        self.responseTime = responseTime

    def getPosition(self, currentTime, lastTime, lastPosition, lastTarget):
        dt = currentTime - lastTime
        if dt &lt; -1e-17: # Exception check here because this would pass through the exponent expression below without causing an error
            raise ValueError(&#34;Current time ({}) must be after lastTime ({})&#34;.format(currentTime, lastTime))
            
        if dt &lt; 0:
            dt = 0

        lastError = lastTarget - lastPosition
        errorFractionRemoved = (1 - e**(-dt/self.responseTime))
        newPosition = lastPosition + lastError*errorFractionRemoved

        return newPosition


class ActuatorController(abc.ABC):
    &#39;&#39;&#39; 
        Interface for actuator controllers.   
        Actuator controllers are in charge of determining what actuator deflections are required to produce moments desired by the rocket&#39;s `MAPLEAF.GNC.ControlSystems.ControlSystem`
    &#39;&#39;&#39;
    @abc.abstractmethod
    def setTargetActuatorDeflections(self, desiredMoments, state, environment, time):
        &#39;&#39;&#39; Should return nothing, control the appropriate rocket system to generate the desired moments &#39;&#39;&#39;
        pass

class TableInterpolatingActuatorController(ActuatorController):
    &#39;&#39;&#39;
        Controls actuators 
    &#39;&#39;&#39;
    def __init__(self, deflectionTableFilePath, nKeyColumns, keyFunctionList, actuatorList):
        self.actuatorList = actuatorList
        self.keyFunctionList = keyFunctionList

        # Load actuator-deflection data table
        deflData = np.loadtxt(deflectionTableFilePath, skiprows=1)
        keys = deflData[:,0:nKeyColumns]
        deflData = deflData[:,nKeyColumns:]

        # Check that number of actuators matches number of deflection entries in the deflection tables
        nActuators = len(actuatorList)
        nDeflectionTableEntries = len(deflData[0,:])
        if nActuators != nDeflectionTableEntries:
            raise ValueError(&#34;Number of actuators: {}, must match number of actuator deflection columns in deflection table: {}&#34;.format(nActuators, nDeflectionTableEntries))

        # Create interpolation function for fin deflections
        self._getPositionTargets = LinearNDInterpolator(keys, deflData)

    def setTargetActuatorDeflections(self, desiredMoments, state, environment, time):
        &#39;&#39;&#39;
            Inputs:
                desiredMoments: (3-length iterable) contains desired moments about the x,y,and z axes
                time:           time at which the moments are requested (time of current control loop execution)
        &#39;&#39;&#39;
        # Construct key vector, starting with non-moment components:
        keyVector = AeroParameters.getAeroPropertiesList(self.keyFunctionList, state, environment)
        for desiredMoment in desiredMoments:
            keyVector.append(desiredMoment)

        newActuatorPositionTargets = self._getPositionTargets(*keyVector)

        for i in range(len(self.actuatorList)):
            self.actuatorList[i].setTargetDeflection(newActuatorPositionTargets[i], time)

        return list(newActuatorPositionTargets)




class Actuator(abc.ABC):
    &#39;&#39;&#39; 
        Interface for actuators.
        Actuators model the movement of a physical actuator (ex. servo, hydraulics).
        Target deflections are usually provided by the rocket&#39;s `MAPLEAF.GNC.ControlSystems.ControlSystem`, usually obtained from a `ActuatorController`
    &#39;&#39;&#39;
    @abc.abstractmethod
    def setTargetDeflection(self, newTarget, time):
        &#39;&#39;&#39; Should return nothing, update setPoint for the actuator &#39;&#39;&#39;
        pass

    @abc.abstractmethod
    def getDeflection(self, time):
        &#39;&#39;&#39; Should return the current deflection &#39;&#39;&#39;
        pass

    @abc.abstractmethod
    def getDeflectionDerivative(self, state, environment, time):
        &#39;&#39;&#39; Should return the current deflection derivative &#39;&#39;&#39;
        pass

class FirstOrderActuator(Actuator, FirstOrderSystem):
    &#39;&#39;&#39;
        First-order system - simple enought that its motion between control loops can be determined analytically.
        Motion does not need to be integrated

        Basically just a version of the FirstOrderSystem class that internally stores state information
    &#39;&#39;&#39;
    def __init__(self, responseTime, initialDeflection=0, initialTime=0, maxDeflection=None, minDeflection=None):
        self.responseTime = responseTime
        self.lastDeflection = initialDeflection
        self.lastTime = 0
        self.targetDeflection = 0
        self.maxDeflection = maxDeflection
        self.minDeflection = minDeflection

    def setTargetDeflection(self, newTarget, time):
        # Record current deflection and time
        self.lastDeflection = self.getDeflection(time)
        self.lastTime = time

        # Apply limiters to new target
        if self.maxDeflection != None:
            newTarget = min(newTarget, self.maxDeflection)
        if self.minDeflection != None:
            newTarget = max(newTarget, self.minDeflection)

        # Set new target
        self.targetDeflection = newTarget

    def getDeflection(self, time):
        return self.getPosition(time, self.lastTime, self.lastDeflection, self.targetDeflection)

    def getDeflectionDerivative(self, _, _2, _3):
        &#39;&#39;&#39; Not required for first-order actuator - deflections can be integrated analytically &#39;&#39;&#39;
        pass</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="MAPLEAF.GNC.Actuators.Actuator"><code class="flex name class">
<span>class <span class="ident">Actuator</span></span>
</code></dt>
<dd>
<div class="desc"><p>Interface for actuators.
Actuators model the movement of a physical actuator (ex. servo, hydraulics).
Target deflections are usually provided by the rocket's <code><a title="MAPLEAF.GNC.ControlSystems.ControlSystem" href="ControlSystems.html#MAPLEAF.GNC.ControlSystems.ControlSystem">ControlSystem</a></code>, usually obtained from a <code><a title="MAPLEAF.GNC.Actuators.ActuatorController" href="#MAPLEAF.GNC.Actuators.ActuatorController">ActuatorController</a></code></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Actuator(abc.ABC):
    &#39;&#39;&#39; 
        Interface for actuators.
        Actuators model the movement of a physical actuator (ex. servo, hydraulics).
        Target deflections are usually provided by the rocket&#39;s `MAPLEAF.GNC.ControlSystems.ControlSystem`, usually obtained from a `ActuatorController`
    &#39;&#39;&#39;
    @abc.abstractmethod
    def setTargetDeflection(self, newTarget, time):
        &#39;&#39;&#39; Should return nothing, update setPoint for the actuator &#39;&#39;&#39;
        pass

    @abc.abstractmethod
    def getDeflection(self, time):
        &#39;&#39;&#39; Should return the current deflection &#39;&#39;&#39;
        pass

    @abc.abstractmethod
    def getDeflectionDerivative(self, state, environment, time):
        &#39;&#39;&#39; Should return the current deflection derivative &#39;&#39;&#39;
        pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="MAPLEAF.GNC.Actuators.FirstOrderActuator" href="#MAPLEAF.GNC.Actuators.FirstOrderActuator">FirstOrderActuator</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="MAPLEAF.GNC.Actuators.Actuator.getDeflection"><code class="name flex">
<span>def <span class="ident">getDeflection</span></span>(<span>self, time)</span>
</code></dt>
<dd>
<div class="desc"><p>Should return the current deflection</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@abc.abstractmethod
def getDeflection(self, time):
    &#39;&#39;&#39; Should return the current deflection &#39;&#39;&#39;
    pass</code></pre>
</details>
</dd>
<dt id="MAPLEAF.GNC.Actuators.Actuator.getDeflectionDerivative"><code class="name flex">
<span>def <span class="ident">getDeflectionDerivative</span></span>(<span>self, state, environment, time)</span>
</code></dt>
<dd>
<div class="desc"><p>Should return the current deflection derivative</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@abc.abstractmethod
def getDeflectionDerivative(self, state, environment, time):
    &#39;&#39;&#39; Should return the current deflection derivative &#39;&#39;&#39;
    pass</code></pre>
</details>
</dd>
<dt id="MAPLEAF.GNC.Actuators.Actuator.setTargetDeflection"><code class="name flex">
<span>def <span class="ident">setTargetDeflection</span></span>(<span>self, newTarget, time)</span>
</code></dt>
<dd>
<div class="desc"><p>Should return nothing, update setPoint for the actuator</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@abc.abstractmethod
def setTargetDeflection(self, newTarget, time):
    &#39;&#39;&#39; Should return nothing, update setPoint for the actuator &#39;&#39;&#39;
    pass</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="MAPLEAF.GNC.Actuators.ActuatorController"><code class="flex name class">
<span>class <span class="ident">ActuatorController</span></span>
</code></dt>
<dd>
<div class="desc"><p>Interface for actuator controllers. <br>
Actuator controllers are in charge of determining what actuator deflections are required to produce moments desired by the rocket's <code><a title="MAPLEAF.GNC.ControlSystems.ControlSystem" href="ControlSystems.html#MAPLEAF.GNC.ControlSystems.ControlSystem">ControlSystem</a></code></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ActuatorController(abc.ABC):
    &#39;&#39;&#39; 
        Interface for actuator controllers.   
        Actuator controllers are in charge of determining what actuator deflections are required to produce moments desired by the rocket&#39;s `MAPLEAF.GNC.ControlSystems.ControlSystem`
    &#39;&#39;&#39;
    @abc.abstractmethod
    def setTargetActuatorDeflections(self, desiredMoments, state, environment, time):
        &#39;&#39;&#39; Should return nothing, control the appropriate rocket system to generate the desired moments &#39;&#39;&#39;
        pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="MAPLEAF.GNC.Actuators.TableInterpolatingActuatorController" href="#MAPLEAF.GNC.Actuators.TableInterpolatingActuatorController">TableInterpolatingActuatorController</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="MAPLEAF.GNC.Actuators.ActuatorController.setTargetActuatorDeflections"><code class="name flex">
<span>def <span class="ident">setTargetActuatorDeflections</span></span>(<span>self, desiredMoments, state, environment, time)</span>
</code></dt>
<dd>
<div class="desc"><p>Should return nothing, control the appropriate rocket system to generate the desired moments</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@abc.abstractmethod
def setTargetActuatorDeflections(self, desiredMoments, state, environment, time):
    &#39;&#39;&#39; Should return nothing, control the appropriate rocket system to generate the desired moments &#39;&#39;&#39;
    pass</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="MAPLEAF.GNC.Actuators.FirstOrderActuator"><code class="flex name class">
<span>class <span class="ident">FirstOrderActuator</span></span>
<span>(</span><span>responseTime, initialDeflection=0, initialTime=0, maxDeflection=None, minDeflection=None)</span>
</code></dt>
<dd>
<div class="desc"><p>First-order system - simple enought that its motion between control loops can be determined analytically.
Motion does not need to be integrated</p>
<p>Basically just a version of the FirstOrderSystem class that internally stores state information</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class FirstOrderActuator(Actuator, FirstOrderSystem):
    &#39;&#39;&#39;
        First-order system - simple enought that its motion between control loops can be determined analytically.
        Motion does not need to be integrated

        Basically just a version of the FirstOrderSystem class that internally stores state information
    &#39;&#39;&#39;
    def __init__(self, responseTime, initialDeflection=0, initialTime=0, maxDeflection=None, minDeflection=None):
        self.responseTime = responseTime
        self.lastDeflection = initialDeflection
        self.lastTime = 0
        self.targetDeflection = 0
        self.maxDeflection = maxDeflection
        self.minDeflection = minDeflection

    def setTargetDeflection(self, newTarget, time):
        # Record current deflection and time
        self.lastDeflection = self.getDeflection(time)
        self.lastTime = time

        # Apply limiters to new target
        if self.maxDeflection != None:
            newTarget = min(newTarget, self.maxDeflection)
        if self.minDeflection != None:
            newTarget = max(newTarget, self.minDeflection)

        # Set new target
        self.targetDeflection = newTarget

    def getDeflection(self, time):
        return self.getPosition(time, self.lastTime, self.lastDeflection, self.targetDeflection)

    def getDeflectionDerivative(self, _, _2, _3):
        &#39;&#39;&#39; Not required for first-order actuator - deflections can be integrated analytically &#39;&#39;&#39;
        pass</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="MAPLEAF.GNC.Actuators.Actuator" href="#MAPLEAF.GNC.Actuators.Actuator">Actuator</a></li>
<li>abc.ABC</li>
<li><a title="MAPLEAF.GNC.Actuators.FirstOrderSystem" href="#MAPLEAF.GNC.Actuators.FirstOrderSystem">FirstOrderSystem</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="MAPLEAF.GNC.Actuators.FirstOrderActuator.getDeflectionDerivative"><code class="name flex">
<span>def <span class="ident">getDeflectionDerivative</span></span>(<span>self, _, _2, _3)</span>
</code></dt>
<dd>
<div class="desc"><p>Not required for first-order actuator - deflections can be integrated analytically</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getDeflectionDerivative(self, _, _2, _3):
    &#39;&#39;&#39; Not required for first-order actuator - deflections can be integrated analytically &#39;&#39;&#39;
    pass</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="MAPLEAF.GNC.Actuators.Actuator" href="#MAPLEAF.GNC.Actuators.Actuator">Actuator</a></b></code>:
<ul class="hlist">
<li><code><a title="MAPLEAF.GNC.Actuators.Actuator.getDeflection" href="#MAPLEAF.GNC.Actuators.Actuator.getDeflection">getDeflection</a></code></li>
<li><code><a title="MAPLEAF.GNC.Actuators.Actuator.setTargetDeflection" href="#MAPLEAF.GNC.Actuators.Actuator.setTargetDeflection">setTargetDeflection</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="MAPLEAF.GNC.Actuators.FirstOrderSystem"><code class="flex name class">
<span>class <span class="ident">FirstOrderSystem</span></span>
<span>(</span><span>responseTime)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class FirstOrderSystem():
    def __init__(self, responseTime):
        self.responseTime = responseTime

    def getPosition(self, currentTime, lastTime, lastPosition, lastTarget):
        dt = currentTime - lastTime
        if dt &lt; -1e-17: # Exception check here because this would pass through the exponent expression below without causing an error
            raise ValueError(&#34;Current time ({}) must be after lastTime ({})&#34;.format(currentTime, lastTime))
            
        if dt &lt; 0:
            dt = 0

        lastError = lastTarget - lastPosition
        errorFractionRemoved = (1 - e**(-dt/self.responseTime))
        newPosition = lastPosition + lastError*errorFractionRemoved

        return newPosition</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="MAPLEAF.GNC.Actuators.FirstOrderActuator" href="#MAPLEAF.GNC.Actuators.FirstOrderActuator">FirstOrderActuator</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="MAPLEAF.GNC.Actuators.FirstOrderSystem.getPosition"><code class="name flex">
<span>def <span class="ident">getPosition</span></span>(<span>self, currentTime, lastTime, lastPosition, lastTarget)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getPosition(self, currentTime, lastTime, lastPosition, lastTarget):
    dt = currentTime - lastTime
    if dt &lt; -1e-17: # Exception check here because this would pass through the exponent expression below without causing an error
        raise ValueError(&#34;Current time ({}) must be after lastTime ({})&#34;.format(currentTime, lastTime))
        
    if dt &lt; 0:
        dt = 0

    lastError = lastTarget - lastPosition
    errorFractionRemoved = (1 - e**(-dt/self.responseTime))
    newPosition = lastPosition + lastError*errorFractionRemoved

    return newPosition</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="MAPLEAF.GNC.Actuators.TableInterpolatingActuatorController"><code class="flex name class">
<span>class <span class="ident">TableInterpolatingActuatorController</span></span>
<span>(</span><span>deflectionTableFilePath, nKeyColumns, keyFunctionList, actuatorList)</span>
</code></dt>
<dd>
<div class="desc"><p>Controls actuators</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TableInterpolatingActuatorController(ActuatorController):
    &#39;&#39;&#39;
        Controls actuators 
    &#39;&#39;&#39;
    def __init__(self, deflectionTableFilePath, nKeyColumns, keyFunctionList, actuatorList):
        self.actuatorList = actuatorList
        self.keyFunctionList = keyFunctionList

        # Load actuator-deflection data table
        deflData = np.loadtxt(deflectionTableFilePath, skiprows=1)
        keys = deflData[:,0:nKeyColumns]
        deflData = deflData[:,nKeyColumns:]

        # Check that number of actuators matches number of deflection entries in the deflection tables
        nActuators = len(actuatorList)
        nDeflectionTableEntries = len(deflData[0,:])
        if nActuators != nDeflectionTableEntries:
            raise ValueError(&#34;Number of actuators: {}, must match number of actuator deflection columns in deflection table: {}&#34;.format(nActuators, nDeflectionTableEntries))

        # Create interpolation function for fin deflections
        self._getPositionTargets = LinearNDInterpolator(keys, deflData)

    def setTargetActuatorDeflections(self, desiredMoments, state, environment, time):
        &#39;&#39;&#39;
            Inputs:
                desiredMoments: (3-length iterable) contains desired moments about the x,y,and z axes
                time:           time at which the moments are requested (time of current control loop execution)
        &#39;&#39;&#39;
        # Construct key vector, starting with non-moment components:
        keyVector = AeroParameters.getAeroPropertiesList(self.keyFunctionList, state, environment)
        for desiredMoment in desiredMoments:
            keyVector.append(desiredMoment)

        newActuatorPositionTargets = self._getPositionTargets(*keyVector)

        for i in range(len(self.actuatorList)):
            self.actuatorList[i].setTargetDeflection(newActuatorPositionTargets[i], time)

        return list(newActuatorPositionTargets)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="MAPLEAF.GNC.Actuators.ActuatorController" href="#MAPLEAF.GNC.Actuators.ActuatorController">ActuatorController</a></li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="MAPLEAF.GNC.Actuators.TableInterpolatingActuatorController.setTargetActuatorDeflections"><code class="name flex">
<span>def <span class="ident">setTargetActuatorDeflections</span></span>(<span>self, desiredMoments, state, environment, time)</span>
</code></dt>
<dd>
<div class="desc"><h2 id="inputs">Inputs</h2>
<p>desiredMoments: (3-length iterable) contains desired moments about the x,y,and z axes
time:
time at which the moments are requested (time of current control loop execution)</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def setTargetActuatorDeflections(self, desiredMoments, state, environment, time):
    &#39;&#39;&#39;
        Inputs:
            desiredMoments: (3-length iterable) contains desired moments about the x,y,and z axes
            time:           time at which the moments are requested (time of current control loop execution)
    &#39;&#39;&#39;
    # Construct key vector, starting with non-moment components:
    keyVector = AeroParameters.getAeroPropertiesList(self.keyFunctionList, state, environment)
    for desiredMoment in desiredMoments:
        keyVector.append(desiredMoment)

    newActuatorPositionTargets = self._getPositionTargets(*keyVector)

    for i in range(len(self.actuatorList)):
        self.actuatorList[i].setTargetDeflection(newActuatorPositionTargets[i], time)

    return list(newActuatorPositionTargets)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<header>
<a class="homelink" rel="home" title="MAPLEAF Home" href="https://henrystoldt.github.io/MAPLEAF/">
<img src="https://raw.githubusercontent.com/henrystoldt/MAPLEAF/master/Resources/DraftLogo.png" alt="Logo" width=75/>
MAPLEAF
</a>
</header>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="MAPLEAF.GNC" href="index.html">MAPLEAF.GNC</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="MAPLEAF.GNC.Actuators.Actuator" href="#MAPLEAF.GNC.Actuators.Actuator">Actuator</a></code></h4>
<ul class="">
<li><code><a title="MAPLEAF.GNC.Actuators.Actuator.getDeflection" href="#MAPLEAF.GNC.Actuators.Actuator.getDeflection">getDeflection</a></code></li>
<li><code><a title="MAPLEAF.GNC.Actuators.Actuator.getDeflectionDerivative" href="#MAPLEAF.GNC.Actuators.Actuator.getDeflectionDerivative">getDeflectionDerivative</a></code></li>
<li><code><a title="MAPLEAF.GNC.Actuators.Actuator.setTargetDeflection" href="#MAPLEAF.GNC.Actuators.Actuator.setTargetDeflection">setTargetDeflection</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="MAPLEAF.GNC.Actuators.ActuatorController" href="#MAPLEAF.GNC.Actuators.ActuatorController">ActuatorController</a></code></h4>
<ul class="">
<li><code><a title="MAPLEAF.GNC.Actuators.ActuatorController.setTargetActuatorDeflections" href="#MAPLEAF.GNC.Actuators.ActuatorController.setTargetActuatorDeflections">setTargetActuatorDeflections</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="MAPLEAF.GNC.Actuators.FirstOrderActuator" href="#MAPLEAF.GNC.Actuators.FirstOrderActuator">FirstOrderActuator</a></code></h4>
<ul class="">
<li><code><a title="MAPLEAF.GNC.Actuators.FirstOrderActuator.getDeflectionDerivative" href="#MAPLEAF.GNC.Actuators.FirstOrderActuator.getDeflectionDerivative">getDeflectionDerivative</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="MAPLEAF.GNC.Actuators.FirstOrderSystem" href="#MAPLEAF.GNC.Actuators.FirstOrderSystem">FirstOrderSystem</a></code></h4>
<ul class="">
<li><code><a title="MAPLEAF.GNC.Actuators.FirstOrderSystem.getPosition" href="#MAPLEAF.GNC.Actuators.FirstOrderSystem.getPosition">getPosition</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="MAPLEAF.GNC.Actuators.TableInterpolatingActuatorController" href="#MAPLEAF.GNC.Actuators.TableInterpolatingActuatorController">TableInterpolatingActuatorController</a></code></h4>
<ul class="">
<li><code><a title="MAPLEAF.GNC.Actuators.TableInterpolatingActuatorController.setTargetActuatorDeflections" href="#MAPLEAF.GNC.Actuators.TableInterpolatingActuatorController.setTargetActuatorDeflections">setTargetActuatorDeflections</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>