<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>MAPLEAF.Main API documentation</title>
<meta name="description" content="Script to run flight simulations from the command line
If MAPLEAF has been installed with pip, this script is accessible through the &#39;mapleaf&#39; command" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>MAPLEAF.Main</code></h1>
</header>
<section id="section-intro">
<p>Script to run flight simulations from the command line
If MAPLEAF has been installed with pip, this script is accessible through the 'mapleaf' command</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#39;&#39;&#39; 
Script to run flight simulations from the command line 
If MAPLEAF has been installed with pip, this script is accessible through the &#39;mapleaf&#39; command
&#39;&#39;&#39;

import argparse
import os
import sys
import time
from typing import List

import MAPLEAF.IO.Logging as Logging
import MAPLEAF.IO.Plotting as Plotting
from MAPLEAF.IO.SimDefinition import SimDefinition
from MAPLEAF.SimulationRunners import (ConvergenceSimRunner, MonteCarloSimRunner,
                                   SingleSimRunner, isMonteCarloSimulation)


def buildParser() -&gt; argparse.ArgumentParser:
    &#39;&#39;&#39; Builds the command-line argument parser using argparse &#39;&#39;&#39;
    parser = argparse.ArgumentParser(description=&#34;&#34;&#34;
    Command line interface for the rocket simulator 
    Runs simulations defined by simulation definition files like those in ./MAPLEAF/Examples/Simulations/ 
    All possible options for sim definition files defined in ./SimDefinitionTemplate.txt
    &#34;&#34;&#34;)

    parser.add_argument(
        &#34;--converge&#34;, 
        action=&#39;store_true&#39;, 
        help=&#34;Runs the current simulation using successively finer time steps, attempting to provide a converged final location&#34;
    )
    parser.add_argument(
        &#34;--compareIntegrationSchemes&#34;, 
        action=&#39;store_true&#39;, 
        help=&#34;Attempts to converge the current simulation using a variety of classical integration schemes.&#34;
    )
    parser.add_argument(
        &#34;--compareAdaptiveIntegrationSchemes&#34;, 
        action=&#39;store_true&#39;, 
        help=&#34;Attempts to converge the current simulation using a variety of adaptive time integration schemes&#34;
    )
    parser.add_argument(
        &#34;--plotFromLog&#34;, 
        nargs=1, 
        default=[], 
        help=&#34;Instead of a path to a sim definition file, provide a path to a log file from a previous simulation. Also provide \
            a plotDefinitionString - works the same way the SimControl.plot entries work&#34;
    )
    parser.add_argument(
        &#34;--silent&#34;, 
        action=&#39;store_true&#39;, 
        help=&#34;If present, simulation(s) are run w/o outputting to console - which can be significantly faster on some setups&#34;
    )
    parser.add_argument(
        &#34;simDefinitionFile&#34;, 
        nargs=1, 
        default=&#34;MAPLEAF/Examples/Simulations/NASATwoStagOrbitalRocket.mapleaf&#34;,
        help=&#34;Path to a simulation definition (.mapleaf) file&#34;
    )

    return parser

def checkForMutuallyExclusiveArgs(args):
    &#39;&#39;&#39; Check that we haven&#39;t passed in mutually exclusive command-line arguments (ex. --converge and --plotFromLog) &#39;&#39;&#39;
    mutuallyExclusiveArgs = [ args.converge, args.compareIntegrationSchemes, args.compareAdaptiveIntegrationSchemes, args.plotFromLog ]
    mutExCount = 0
    for item in mutuallyExclusiveArgs:
        if item == True:
            mutExCount += 1
    if mutExCount &gt; 1:
        print(&#34;ERROR: --converge, --compareIntegrationSchemes, --compareAdaptiveIntegrationSchemes, and --plotFromLog are mutually exclusive. Please only use one at a time.&#34;)
        sys.exit()

def main(argv: List[str]=None) -&gt; int:
    &#39;&#39;&#39; 
        Main function to run a MAPLEAF simulation. 
        Expects to be called from the command line, using the argparse parser
        
        For testing purposes, can also pass a list of command line arguments into the argv parameter
    &#39;&#39;&#39;
    startTime = time.time()
    parser = buildParser()

    args = parser.parse_args(argv)
    
    checkForMutuallyExclusiveArgs(args)    

    # Check if we actually just want to plot a column from a log file, and not run a whole simulation
    if len(args.plotFromLog):
        Plotting.plotFromLogFiles([args.simDefinitionFile[0]], args.plotFromLog[0])
        print(&#34;Exiting&#34;)
        sys.exit()

    # Load simulation definition file
    if not os.path.isfile(args.simDefinitionFile[0]):
        print(&#34;ERROR: Simulation definition file: {} does not exist!&#34;.format(args.simDefinitionFile))
        sys.exit()
        
    simDef = SimDefinition(args.simDefinitionFile[0])

    #### Run simulation(s) ####
    # Monte Carlo Sim
    if isMonteCarloSimulation(simDef):
        mCSimRunner = MonteCarloSimRunner(simDefinition=simDef, silent=args.silent)
        mCSimRunner.runMonteCarloSimulation()

    # Convergence Sim
    elif args.converge or args.compareIntegrationSchemes or args.compareAdaptiveIntegrationSchemes: 
        cSimRunner = ConvergenceSimRunner(simDefinition=simDef, silent=args.silent)
        if args.converge:
            cSimRunner.convergeSimEndPosition()
        elif args.compareIntegrationSchemes:
            cSimRunner.compareClassicalIntegrationSchemes(convergenceResultFilePath=&#39;convergenceResult.csv&#39;)
        elif args.compareAdaptiveIntegrationSchemes:
            cSimRunner.compareAdaptiveIntegrationSchemes(convergenceResultFilePath=&#39;adaptiveConvergenceResult.csv&#39;)
    
    # Regular, single simulation  
    else: 
        simRunner = SingleSimRunner(simDefinition=simDef, silent=args.silent)
        simRunner.runSingleSimulation()

    Logging.removeLogger()

    print(&#34;Run time: {:1.2f} seconds&#34;.format(time.time() - startTime))
    print(&#34;Exiting&#34;)

if __name__ == &#34;__main__&#34;:
    main()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="MAPLEAF.Main.buildParser"><code class="name flex">
<span>def <span class="ident">buildParser</span></span>(<span>) ‑> argparse.ArgumentParser</span>
</code></dt>
<dd>
<div class="desc"><p>Builds the command-line argument parser using argparse</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def buildParser() -&gt; argparse.ArgumentParser:
    &#39;&#39;&#39; Builds the command-line argument parser using argparse &#39;&#39;&#39;
    parser = argparse.ArgumentParser(description=&#34;&#34;&#34;
    Command line interface for the rocket simulator 
    Runs simulations defined by simulation definition files like those in ./MAPLEAF/Examples/Simulations/ 
    All possible options for sim definition files defined in ./SimDefinitionTemplate.txt
    &#34;&#34;&#34;)

    parser.add_argument(
        &#34;--converge&#34;, 
        action=&#39;store_true&#39;, 
        help=&#34;Runs the current simulation using successively finer time steps, attempting to provide a converged final location&#34;
    )
    parser.add_argument(
        &#34;--compareIntegrationSchemes&#34;, 
        action=&#39;store_true&#39;, 
        help=&#34;Attempts to converge the current simulation using a variety of classical integration schemes.&#34;
    )
    parser.add_argument(
        &#34;--compareAdaptiveIntegrationSchemes&#34;, 
        action=&#39;store_true&#39;, 
        help=&#34;Attempts to converge the current simulation using a variety of adaptive time integration schemes&#34;
    )
    parser.add_argument(
        &#34;--plotFromLog&#34;, 
        nargs=1, 
        default=[], 
        help=&#34;Instead of a path to a sim definition file, provide a path to a log file from a previous simulation. Also provide \
            a plotDefinitionString - works the same way the SimControl.plot entries work&#34;
    )
    parser.add_argument(
        &#34;--silent&#34;, 
        action=&#39;store_true&#39;, 
        help=&#34;If present, simulation(s) are run w/o outputting to console - which can be significantly faster on some setups&#34;
    )
    parser.add_argument(
        &#34;simDefinitionFile&#34;, 
        nargs=1, 
        default=&#34;MAPLEAF/Examples/Simulations/NASATwoStagOrbitalRocket.mapleaf&#34;,
        help=&#34;Path to a simulation definition (.mapleaf) file&#34;
    )

    return parser</code></pre>
</details>
</dd>
<dt id="MAPLEAF.Main.checkForMutuallyExclusiveArgs"><code class="name flex">
<span>def <span class="ident">checkForMutuallyExclusiveArgs</span></span>(<span>args)</span>
</code></dt>
<dd>
<div class="desc"><p>Check that we haven't passed in mutually exclusive command-line arguments (ex. &ndash;converge and &ndash;plotFromLog)</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def checkForMutuallyExclusiveArgs(args):
    &#39;&#39;&#39; Check that we haven&#39;t passed in mutually exclusive command-line arguments (ex. --converge and --plotFromLog) &#39;&#39;&#39;
    mutuallyExclusiveArgs = [ args.converge, args.compareIntegrationSchemes, args.compareAdaptiveIntegrationSchemes, args.plotFromLog ]
    mutExCount = 0
    for item in mutuallyExclusiveArgs:
        if item == True:
            mutExCount += 1
    if mutExCount &gt; 1:
        print(&#34;ERROR: --converge, --compareIntegrationSchemes, --compareAdaptiveIntegrationSchemes, and --plotFromLog are mutually exclusive. Please only use one at a time.&#34;)
        sys.exit()</code></pre>
</details>
</dd>
<dt id="MAPLEAF.Main.main"><code class="name flex">
<span>def <span class="ident">main</span></span>(<span>argv: List[str] = None) ‑> int</span>
</code></dt>
<dd>
<div class="desc"><p>Main function to run a MAPLEAF simulation.
Expects to be called from the command line, using the argparse parser</p>
<p>For testing purposes, can also pass a list of command line arguments into the argv parameter</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def main(argv: List[str]=None) -&gt; int:
    &#39;&#39;&#39; 
        Main function to run a MAPLEAF simulation. 
        Expects to be called from the command line, using the argparse parser
        
        For testing purposes, can also pass a list of command line arguments into the argv parameter
    &#39;&#39;&#39;
    startTime = time.time()
    parser = buildParser()

    args = parser.parse_args(argv)
    
    checkForMutuallyExclusiveArgs(args)    

    # Check if we actually just want to plot a column from a log file, and not run a whole simulation
    if len(args.plotFromLog):
        Plotting.plotFromLogFiles([args.simDefinitionFile[0]], args.plotFromLog[0])
        print(&#34;Exiting&#34;)
        sys.exit()

    # Load simulation definition file
    if not os.path.isfile(args.simDefinitionFile[0]):
        print(&#34;ERROR: Simulation definition file: {} does not exist!&#34;.format(args.simDefinitionFile))
        sys.exit()
        
    simDef = SimDefinition(args.simDefinitionFile[0])

    #### Run simulation(s) ####
    # Monte Carlo Sim
    if isMonteCarloSimulation(simDef):
        mCSimRunner = MonteCarloSimRunner(simDefinition=simDef, silent=args.silent)
        mCSimRunner.runMonteCarloSimulation()

    # Convergence Sim
    elif args.converge or args.compareIntegrationSchemes or args.compareAdaptiveIntegrationSchemes: 
        cSimRunner = ConvergenceSimRunner(simDefinition=simDef, silent=args.silent)
        if args.converge:
            cSimRunner.convergeSimEndPosition()
        elif args.compareIntegrationSchemes:
            cSimRunner.compareClassicalIntegrationSchemes(convergenceResultFilePath=&#39;convergenceResult.csv&#39;)
        elif args.compareAdaptiveIntegrationSchemes:
            cSimRunner.compareAdaptiveIntegrationSchemes(convergenceResultFilePath=&#39;adaptiveConvergenceResult.csv&#39;)
    
    # Regular, single simulation  
    else: 
        simRunner = SingleSimRunner(simDefinition=simDef, silent=args.silent)
        simRunner.runSingleSimulation()

    Logging.removeLogger()

    print(&#34;Run time: {:1.2f} seconds&#34;.format(time.time() - startTime))
    print(&#34;Exiting&#34;)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="MAPLEAF" href="index.html">MAPLEAF</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="MAPLEAF.Main.buildParser" href="#MAPLEAF.Main.buildParser">buildParser</a></code></li>
<li><code><a title="MAPLEAF.Main.checkForMutuallyExclusiveArgs" href="#MAPLEAF.Main.checkForMutuallyExclusiveArgs">checkForMutuallyExclusiveArgs</a></code></li>
<li><code><a title="MAPLEAF.Main.main" href="#MAPLEAF.Main.main">main</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>