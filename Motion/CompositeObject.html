<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>MAPLEAF.Motion.CompositeObject API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>MAPLEAF.Motion.CompositeObject</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">from MAPLEAF.Rocket.AeroFunctions import cacheLastResult
from MAPLEAF.Motion.ForceMomentSystem import ForceMomentSystem
from MAPLEAF.Motion.Inertia import Inertia
from MAPLEAF.Rocket.RocketComponents import FixedMass
from MAPLEAF.Motion.CythonVector import Vector

class CompositeObject():
    &#34;&#34;&#34;
        Represents a collection of physical objects with masses.
        Expects:
            Components to have the following methods:
                .getAeroForce(state, time, environmentalConditions, rocketCG)
                .getInertia(time)
                .getMass(time) (optional as long as getInertia is implemented)
            Objects that inherit from FixedMass to be fixed mass objects. Their inertias are cached and not recomputed
            Objects that do not inherit from FixedMass to be variable mass objects. Their inertias are recalculated all the time.
    &#34;&#34;&#34;
    def __init__(self, components=[], CGOverride=None, MOIOverride=None, massOverride=None):
        self.components = components

        self.CGOverride = CGOverride
        self.MOIOverride = MOIOverride
        self.massOverride = massOverride

        # Initialize lists of fixed and variable-mass components
        self.fixedMassComponents = []
        self.variableMassComponents = []
        self._initializeComponentLists()

        # Pre-calculate inertia of all fixed-mass components
        self.fixedMassInertiaComponent = None
        self.fixedMassMassComponent = None
        self._initializeFixedMassInertia()

        #TODO: Add ability to override aero-properties

    def _initializeComponentLists(self):
        # Sort component lists
        self.fixedMassComponents = []
        self.variableMassComponents = []

        for component in self.components:
            if isinstance(component, FixedMass):
                self.fixedMassComponents.append(component)
            else:
                self.variableMassComponents.append(component)

    def _initializeFixedMassInertia(self):
        if len(self.fixedMassComponents) &gt; 0:
            inertiasList = []
            for fixedMassComponent in self.fixedMassComponents:
                inertiasList.append(fixedMassComponent.getInertia(0, None))

            self.fixedMassInertiaComponent = inertiasList[0].combineInertias(inertiasList)
            self.fixedMassMassComponent = self.fixedMassInertiaComponent.mass
        else:
            self.fixedMassInertiaComponent = Inertia(Vector(0,0,0), Vector(0,0,0), 0)
            self.fixedMassMassComponent = 0

    def recomputeFixedMassInertia(self):
        &#39;&#39;&#39; Intended to be called if fixedMass components are added/removed or modified from the composite object &#39;&#39;&#39;

        self._initializeComponentLists()
        self._initializeFixedMassInertia()

        # Try to recompute inertias of sub-object, in case any of them are also CompositeObjects
            # This happens in the case of a Rocket, where the components are Stages (also CompositeObjects)
        for component in self.components:
            try:
                component.recomputeFixedMassInertia()
            except AttributeError:
                pass # Not a CompositeObject

    #TODO: Compute forces at interfaces between components
    @cacheLastResult
    def getAeroForce(self, state, time, environmentalConditions, rocketCG):
        &#39;&#39;&#39;
            Computes the aerodynamic force experienced by the stage.
            Does not include gravitational force - this is expected to be added at the rocket level.
        &#39;&#39;&#39;
        # Add up forces from all subcomponents
        totalAppliedComponentForce = ForceMomentSystem(Vector(0,0,0), rocketCG)
        for component in self.components:
            totalAppliedComponentForce += component.getAeroForce(state, time, environmentalConditions, rocketCG)

        return totalAppliedComponentForce

    @cacheLastResult
    def getInertia(self, time, state):
        &#39;&#39;&#39; Returns an Inertia object, used for 6DoF computations &#39;&#39;&#39;            
        # Add up component inertias
        inertiasList = [ self.fixedMassInertiaComponent ]

        for component in self.variableMassComponents:
            inertiasList.append(component.getInertia(time, state))

        combinedInertia = inertiasList[0].combineInertias(inertiasList)

        # Overrides
        if self.CGOverride != None:
            combinedInertia.CG = self.CGOverride
            combinedInertia.MOICentroidLocation = self.CGOverride
        if self.MOIOverride != None:
            combinedInertia.MOI = self.MOIOverride
        if self.massOverride != None:
            combinedInertia.mass = self.massOverride

        return combinedInertia

    @cacheLastResult
    def getMass(self, time, state):
        &#39;&#39;&#39; 
            Returns an inertia object where the CG and MOI members are zero.
            Only the mass is filled out correctly.
            Used for 3DoF computations 
        &#39;&#39;&#39;
        if self.massOverride == None:
            totalMass = self.fixedMassMassComponent
            for component in self.variableMassComponents:
                try:
                    totalMass += component.getMass(time, state).mass
                except AttributeError:
                    totalMass += component.getInertia(time, state).mass
        else:
            return self.massOverride

        return totalMass

    def getCG(self, time, state):
        return self.getInertia(time, state).CG</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="MAPLEAF.Motion.CompositeObject.CompositeObject"><code class="flex name class">
<span>class <span class="ident">CompositeObject</span></span>
<span>(</span><span>components=[], CGOverride=None, MOIOverride=None, massOverride=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Represents a collection of physical objects with masses.</p>
<h2 id="expects">Expects</h2>
<p>Components to have the following methods:
.getAeroForce(state, time, environmentalConditions, rocketCG)
.getInertia(time)
.getMass(time) (optional as long as getInertia is implemented)
Objects that inherit from FixedMass to be fixed mass objects. Their inertias are cached and not recomputed
Objects that do not inherit from FixedMass to be variable mass objects. Their inertias are recalculated all the time.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CompositeObject():
    &#34;&#34;&#34;
        Represents a collection of physical objects with masses.
        Expects:
            Components to have the following methods:
                .getAeroForce(state, time, environmentalConditions, rocketCG)
                .getInertia(time)
                .getMass(time) (optional as long as getInertia is implemented)
            Objects that inherit from FixedMass to be fixed mass objects. Their inertias are cached and not recomputed
            Objects that do not inherit from FixedMass to be variable mass objects. Their inertias are recalculated all the time.
    &#34;&#34;&#34;
    def __init__(self, components=[], CGOverride=None, MOIOverride=None, massOverride=None):
        self.components = components

        self.CGOverride = CGOverride
        self.MOIOverride = MOIOverride
        self.massOverride = massOverride

        # Initialize lists of fixed and variable-mass components
        self.fixedMassComponents = []
        self.variableMassComponents = []
        self._initializeComponentLists()

        # Pre-calculate inertia of all fixed-mass components
        self.fixedMassInertiaComponent = None
        self.fixedMassMassComponent = None
        self._initializeFixedMassInertia()

        #TODO: Add ability to override aero-properties

    def _initializeComponentLists(self):
        # Sort component lists
        self.fixedMassComponents = []
        self.variableMassComponents = []

        for component in self.components:
            if isinstance(component, FixedMass):
                self.fixedMassComponents.append(component)
            else:
                self.variableMassComponents.append(component)

    def _initializeFixedMassInertia(self):
        if len(self.fixedMassComponents) &gt; 0:
            inertiasList = []
            for fixedMassComponent in self.fixedMassComponents:
                inertiasList.append(fixedMassComponent.getInertia(0, None))

            self.fixedMassInertiaComponent = inertiasList[0].combineInertias(inertiasList)
            self.fixedMassMassComponent = self.fixedMassInertiaComponent.mass
        else:
            self.fixedMassInertiaComponent = Inertia(Vector(0,0,0), Vector(0,0,0), 0)
            self.fixedMassMassComponent = 0

    def recomputeFixedMassInertia(self):
        &#39;&#39;&#39; Intended to be called if fixedMass components are added/removed or modified from the composite object &#39;&#39;&#39;

        self._initializeComponentLists()
        self._initializeFixedMassInertia()

        # Try to recompute inertias of sub-object, in case any of them are also CompositeObjects
            # This happens in the case of a Rocket, where the components are Stages (also CompositeObjects)
        for component in self.components:
            try:
                component.recomputeFixedMassInertia()
            except AttributeError:
                pass # Not a CompositeObject

    #TODO: Compute forces at interfaces between components
    @cacheLastResult
    def getAeroForce(self, state, time, environmentalConditions, rocketCG):
        &#39;&#39;&#39;
            Computes the aerodynamic force experienced by the stage.
            Does not include gravitational force - this is expected to be added at the rocket level.
        &#39;&#39;&#39;
        # Add up forces from all subcomponents
        totalAppliedComponentForce = ForceMomentSystem(Vector(0,0,0), rocketCG)
        for component in self.components:
            totalAppliedComponentForce += component.getAeroForce(state, time, environmentalConditions, rocketCG)

        return totalAppliedComponentForce

    @cacheLastResult
    def getInertia(self, time, state):
        &#39;&#39;&#39; Returns an Inertia object, used for 6DoF computations &#39;&#39;&#39;            
        # Add up component inertias
        inertiasList = [ self.fixedMassInertiaComponent ]

        for component in self.variableMassComponents:
            inertiasList.append(component.getInertia(time, state))

        combinedInertia = inertiasList[0].combineInertias(inertiasList)

        # Overrides
        if self.CGOverride != None:
            combinedInertia.CG = self.CGOverride
            combinedInertia.MOICentroidLocation = self.CGOverride
        if self.MOIOverride != None:
            combinedInertia.MOI = self.MOIOverride
        if self.massOverride != None:
            combinedInertia.mass = self.massOverride

        return combinedInertia

    @cacheLastResult
    def getMass(self, time, state):
        &#39;&#39;&#39; 
            Returns an inertia object where the CG and MOI members are zero.
            Only the mass is filled out correctly.
            Used for 3DoF computations 
        &#39;&#39;&#39;
        if self.massOverride == None:
            totalMass = self.fixedMassMassComponent
            for component in self.variableMassComponents:
                try:
                    totalMass += component.getMass(time, state).mass
                except AttributeError:
                    totalMass += component.getInertia(time, state).mass
        else:
            return self.massOverride

        return totalMass

    def getCG(self, time, state):
        return self.getInertia(time, state).CG</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="MAPLEAF.Rocket.Rocket.Rocket" href="../Rocket/Rocket.html#MAPLEAF.Rocket.Rocket.Rocket">Rocket</a></li>
<li><a title="MAPLEAF.Rocket.Stage.Stage" href="../Rocket/Stage.html#MAPLEAF.Rocket.Stage.Stage">Stage</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="MAPLEAF.Motion.CompositeObject.CompositeObject.getAeroForce"><code class="name flex">
<span>def <span class="ident">getAeroForce</span></span>(<span>*args)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def memoized_func(*args):
    # Return cached result if available
    if cache[1] == args:
        return cache[2]
    
    # Compute and cache result
    result = func(*args)
    cache[1] = args
    cache[2] = result
    return result</code></pre>
</details>
</dd>
<dt id="MAPLEAF.Motion.CompositeObject.CompositeObject.getCG"><code class="name flex">
<span>def <span class="ident">getCG</span></span>(<span>self, time, state)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getCG(self, time, state):
    return self.getInertia(time, state).CG</code></pre>
</details>
</dd>
<dt id="MAPLEAF.Motion.CompositeObject.CompositeObject.getInertia"><code class="name flex">
<span>def <span class="ident">getInertia</span></span>(<span>*args)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def memoized_func(*args):
    # Return cached result if available
    if cache[1] == args:
        return cache[2]
    
    # Compute and cache result
    result = func(*args)
    cache[1] = args
    cache[2] = result
    return result</code></pre>
</details>
</dd>
<dt id="MAPLEAF.Motion.CompositeObject.CompositeObject.getMass"><code class="name flex">
<span>def <span class="ident">getMass</span></span>(<span>*args)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def memoized_func(*args):
    # Return cached result if available
    if cache[1] == args:
        return cache[2]
    
    # Compute and cache result
    result = func(*args)
    cache[1] = args
    cache[2] = result
    return result</code></pre>
</details>
</dd>
<dt id="MAPLEAF.Motion.CompositeObject.CompositeObject.recomputeFixedMassInertia"><code class="name flex">
<span>def <span class="ident">recomputeFixedMassInertia</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Intended to be called if fixedMass components are added/removed or modified from the composite object</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def recomputeFixedMassInertia(self):
    &#39;&#39;&#39; Intended to be called if fixedMass components are added/removed or modified from the composite object &#39;&#39;&#39;

    self._initializeComponentLists()
    self._initializeFixedMassInertia()

    # Try to recompute inertias of sub-object, in case any of them are also CompositeObjects
        # This happens in the case of a Rocket, where the components are Stages (also CompositeObjects)
    for component in self.components:
        try:
            component.recomputeFixedMassInertia()
        except AttributeError:
            pass # Not a CompositeObject</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="MAPLEAF.Motion" href="index.html">MAPLEAF.Motion</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="MAPLEAF.Motion.CompositeObject.CompositeObject" href="#MAPLEAF.Motion.CompositeObject.CompositeObject">CompositeObject</a></code></h4>
<ul class="">
<li><code><a title="MAPLEAF.Motion.CompositeObject.CompositeObject.getAeroForce" href="#MAPLEAF.Motion.CompositeObject.CompositeObject.getAeroForce">getAeroForce</a></code></li>
<li><code><a title="MAPLEAF.Motion.CompositeObject.CompositeObject.getCG" href="#MAPLEAF.Motion.CompositeObject.CompositeObject.getCG">getCG</a></code></li>
<li><code><a title="MAPLEAF.Motion.CompositeObject.CompositeObject.getInertia" href="#MAPLEAF.Motion.CompositeObject.CompositeObject.getInertia">getInertia</a></code></li>
<li><code><a title="MAPLEAF.Motion.CompositeObject.CompositeObject.getMass" href="#MAPLEAF.Motion.CompositeObject.CompositeObject.getMass">getMass</a></code></li>
<li><code><a title="MAPLEAF.Motion.CompositeObject.CompositeObject.recomputeFixedMassInertia" href="#MAPLEAF.Motion.CompositeObject.CompositeObject.recomputeFixedMassInertia">recomputeFixedMassInertia</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>